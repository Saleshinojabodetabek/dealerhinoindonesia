##############################################

# ðŸ”’ ADMIN PANEL SECURITY

##############################################

# Disable directory listing

Options -Indexes

# Protect config and system files

<FilesMatch "^(config\.php|function\.php|\.htaccess|\.htpasswd)$">
Require all denied
</FilesMatch>

# Deny access to sensitive extensions

<FilesMatch "\.(bak|sql|ini|log|conf|env)$">
Require all denied
</FilesMatch>

# Protect API folder (so user cannot directly open /admin/api/)

# Lindungi hanya jika diakses langsung via browser

<IfModule mod_rewrite.c>
    RewriteEngine On

    # Hanya izinkan akses API dari domain sendiri
    RewriteCond %{HTTP_REFERER} !^https?://(www\.)?dealerhinoindonesia\.com [NC]
    RewriteRule ^api/ - [F,L]

</IfModule>

# Allow only through PHP scripts inside admin

<IfModule mod_rewrite.c>
    RewriteEngine On

    # Block direct access to admin API files
    RewriteRule ^api/ - [F,L,NC]

</IfModule>

##############################################

# âœ… End of admin security config

##############################################
